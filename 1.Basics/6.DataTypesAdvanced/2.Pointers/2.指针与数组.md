
&emsp;
# 指针和数组
在数组中使用中括号 `[]` 来指索引（index）。中括号 `[]` 也叫位移（offset）操作符，它相当于在指针中的地址上加上括号中的 `数字*nBytes`, nBytes 是数据类型占的内存空间

&emsp;
## 1 一维数组
数组名相当于它的第一个元素的地址，就像一个指针，指向第一个元素的地址，因此其实它们是同一个东西


>Example 1: 数组名的本质
- array 是一个数组名，数组名的本质是一个 `* const`
- ptr 只是一个普通的指针变量

```c++
#include <iostream>
using namespace std;

int main()
{
    int array[10];
    int* ptr = array; 
    
    printf("%-22s: %p\n", "essence of array name", array);
    printf("%-22s: %p\n", "address of 1st element", &array[0]);
    printf("%-22s: %p\n", "value of ptr", ptr);

    return 0;
}
```

&emsp;
>Example 2: 索引的本质
```c++
#include <iostream>
using namespace std;

int main()
{
    int array[10];
    array[5] = 555;     // a[offset of 5] = 0;
    *(array + 6) = 666; // value pointed by (a+6) = 0;
    
    printf("value of array[5]    : %d\n", array[5]);
    printf("value of array[6]    : %d\n", array[6]);
    printf("value of *(array + 6): %d\n", *(array + 6));

    return 0;
}
```

&emsp;
>Example 3: 综合练习
- 指向数组的指针
```c++
#include <iostream>
using namespace std;
int main() {
    int numbers[5];
    int * p;
    p = numbers; // p 指向数组 numbers的第一个元素位置
    *p = 10;     // 对 numbers 的第一个元素进行赋值
    p++;         // 指针 offset+1，即 numbers[1]
    *p = 20;     // numbers[1] = 20
    p = &numbers[2];  // 此时指针指向 nubmers[2]
    *p = 30;          // numbers[2] = 30
    p = numbers + 3;  // numbers 其实本身就是指针，相当于numbers[0]，numbers+3 相当于 numbers[3]
    *p = 40;          // numbers[3] = 4
    p = numbers;      // 又回到最初的起点
    *(p + 4) = 50;    // numbers[4] = 50
    for (int n = 0; n < 5; n++)     // 遍历打印输出
        cout << numbers[n] << ", ";
    cout << endl;
    return 0;
}
```




&emsp;
## 2 多维数组
>多维数组的索引（以3维数组为例）
- 数组维度：`dim[d1][d2][d3]`
- 数组索引：`index[x][y][z] = index[x*(d2*d3) + y*(d2) + d3]`

<div align=center>
    <image src="imgs/array.png" width=500>
</div>

&emsp;
>Example 1
- `array[i][j]`, it is actually a syntactic sugar for `*(*(array + i) + j)`
- `array[i][j][k]`, it is actually a syntactic sugar for `*(*(array + i) + j)`
```c++
int main()
{
    int a[3][2][2] = {0,1,2,3,4,5,6,7,8,9,10,11};

    // 多维数组的索引是每个维度对应的首地址
    // 相当于 (4int)* ptr 偏移量是后面维度的乘积
    // 想按单个元素索引，需要将其转成 int* (4个字节偏移量)
    int* p = (int*)a;     
    cout << p[0] << endl;
    cout << p[10] << endl;

    return 0;
}
```